package jwt

import (
	"testing"

	"github.com/imylam/modules-go/jwt/signer/jwt_rs256"
)

var (
	refRS256JwtString1 string = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJjIyI6Ik1pY3Jvc29mdCIsImdvbGFuZyI6Ikdvb2dsZSJ9.muDiMNErqOZeLavxjDOs6Z7fBhScEcfHt4Obav9Lar003C7NOgWkgnjK7lfPtVlhqJ3il2U11tEijk-Rs93UpZ0WHRT4rC4MgVjCIBDIxUttwPxLb7ax6JTQPTuExqzk8ymSVJUwRYayQ7snnrUNyH9845FzFNBPgLvzS-IfAPSCX5eSeScOue3-0TEBRfbmtnKKbkeALjxBypPlhxkVlsLtkpt4vu09x9WrBcXMnxaNzZn3OJxfLhzfYgoXo5P6xl1fdHbDD-ZfcbqWKYMmYGXGnPgh6v3KroovOvhd345HjhZ-01BD_xAdbwQtrntti714oImdlTDmqXIUWzXYJw"
	refRS256JwtString2 string = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJjIyI6Ik1pY3Jvc29mdCIsImdvbGFuZyI6Ikdvb2dsZSJ9.AH2s9DZt9oRrREB2yPC_Dn167uCa2KBBYAoDtni6KBornZBT1O63FcZje7V3eWEAATPuEgWwIdqaL5yhAenwk3v86vDodyTKbezQgMEa48bNIZRdLSwXiFX9B8v2MnYgJrK_KBGaDKZWstrj_PmlnRbzxOTagZ4nVeDm4BBaPWXtd0V496Z_oq3Joewb9XCUSErNYvZl_ZoiRGGZY1THuQPKuEnp4mbLKy9qsrMh8JgFLYiVtiO-FFLxsHXOD9D0Udv5YNeWDXiF9rtoHh83tQ8RRI9vb0YfbrZnUf7-G_OAuU6V8kIabhIFeVgL2TCaPXhNhjUOpZMEuNFsqdrqfA"
)

func TestRS256TokenAgainstReferencePkcs1Pkix(t *testing.T) {
	SharedTestTokenAgainstStandard(t, jwt_rs256.NewJwtRS256Pkcs1Pkix(), refPkcs1PrivateKeyPem2, refRS256JwtString2)
}

func TestRS256VerifyWithReferencePkcs1(t *testing.T) {
	SharedTestVerifyWithReference(t, jwt_rs256.NewJwtRS256Pkcs1(), refPkcs1PublicKeyPem1, refRS256JwtString1)
}

func TestRS256VerifyWithReferencePkcs1Pkix(t *testing.T) {
	SharedTestVerifyWithReference(t, jwt_rs256.NewJwtRS256Pkcs1Pkix(), refPkixPublicKeyPem2, refRS256JwtString2)
}

func TestRS256TokenThenVerifyPkcs1(t *testing.T) {
	SharedTestTokenThenVerify(t, jwt_rs256.NewJwtRS256Pkcs1(), refPkcs1PrivateKeyPem1, refPkcs1PublicKeyPem1)
}

func TestRS256TokenThenVerify(t *testing.T) {
	SharedTestTokenThenVerify(t, jwt_rs256.NewJwtRS256Pkcs1Pkix(), refPkcs1PrivateKeyPem2, refPkixPublicKeyPem2)
}
